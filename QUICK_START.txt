╔════════════════════════════════════════════════════════════╗
║         Assignment Template Generator - Quick Start         ║
╚════════════════════════════════════════════════════════════╝

BASIC USAGE
===========

1. Run the generator:
   python3 generate_assignment.py

2. Answer the prompts:
   - Assignment name: (e.g., "Android XML")
   - Assignment ID: (e.g., "164")
   - Description: (e.g., "Change Hello World to Hi Android")
   - Build image?: y/n
   - Image name: (default: assignment-x86)

3. Generated folder contains:
   ├── Dockerfile
   ├── docker-compose.yml
   ├── runner.sh
   ├── enhance_json.py
   ├── conftest.py
   ├── pytest.ini
   ├── test_assignment.py (edit this)
   ├── startercode.zip
   ├── solution.zip
   ├── README.md
   ├── ARCHITECTURE.md
   └── src/ (student submission directory)


KEY WORKFLOW
============

Step 1: Generate Template
  python3 generate_assignment.py

Step 2: Edit Test Cases
  Open test_assignment.py and write your tests

Step 3: Create Zips
  Update startercode.zip (student template)
  Update solution.zip (complete solution)

Step 4: Build Docker Image (amd64)
  docker buildx build --platform linux/amd64 -t assignment-x86:latest <folder>/

Step 5: Save for Deployment
  docker save -o x86.tar assignment-x86:latest

Step 6: Deploy
  Send x86.tar and docker-compose.yml to platform


DOCKER COMMANDS
===============

Build for amd64 (web platforms):
  docker buildx build --platform linux/amd64 -t assignment-x86:latest .

Save image:
  docker save -o x86.tar assignment-x86:latest

Load image (on deployment server):
  docker load -i x86.tar

Run with docker-compose:
  docker-compose up

Run manually:
  docker run -v ./src:/app/submission:ro assignment-x86:latest


TESTING LOCALLY
===============

1. Create test submission in src/ folder
2. Run: docker-compose up
3. Check JSON output
4. Verify marks and percentage calculations

Example src/main.xml:
  <?xml version="1.0" encoding="utf-8"?>
  <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
      android:layout_width="match_parent"
      android:layout_height="match_parent"
      android:gravity="center">
      <TextView
          android:layout_width="wrap_content"
          android:layout_height="wrap_content"
          android:text="Hi Android" />
  </LinearLayout>


JSON OUTPUT FORMAT
==================

{
  "created": "2024-01-15T10:30:00Z",
  "duration": 0.456,
  "summary": {
    "passed": 10,
    "failed": 0,
    "total": 10,
    "collected": 10
  },
  "stats": {
    "total_tests": 10,
    "passed": 10,
    "failed": 0,
    "marks": 1.0,
    "percentage": 100.0
  }
}


IMPORTANT NOTES
===============

✓ Exit code ALWAYS 0 (errors reported in JSON)
✓ PYTHONPATH automatically configured
✓ Python 3.11-slim base image
✓ amd64 architecture (for web platforms)
✓ Exit code 0 GUARANTEED

If tests fail:
- Check test_assignment.py syntax
- Verify submission files in src/
- Check JSON stats for error details
- Review runner.sh and enhance_json.py


FILE DESCRIPTIONS
=================

Dockerfile
  - Builds Docker container
  - Base: python:3.11-slim
  - Installs: pytest, pytest-json-report, lxml
  - Platform: linux/amd64

runner.sh
  - Entry point script
  - Exports PYTHONPATH
  - Runs pytest with JSON output
  - Calls enhance_json.py
  - Always exits 0

enhance_json.py
  - Reads pytest JSON report
  - Adds stats section (marks, percentage)
  - Always outputs valid JSON
  - Always exits 0

test_assignment.py
  - Your test cases go here
  - Uses pytest framework
  - Tests validate student submissions

docker-compose.yml
  - Container orchestration
  - Mounts src/ as submission
  - Resource limits (1 CPU, 512M RAM)
  - stdin_open: true, tty: true


TROUBLESHOOTING
===============

Image doesn't build:
  - Check Docker is running
  - Verify buildx is installed: docker buildx version
  - Check Dockerfile syntax

Exit code not 0:
  - Shouldn't happen - always exits 0
  - Check runner.sh and enhance_json.py

No JSON output:
  - Check /tmp/report.json exists in container
  - Verify enhance_json.py is executable
  - Check Python version (3.11)

Tests not running:
  - Check test_assignment.py syntax
  - Verify conftest.py PYTHONPATH
  - Check pytest.ini settings

Wrong architecture:
  - Use: docker buildx build --platform linux/amd64
  - Verify with: docker image inspect assignment-x86:latest


EXAMPLES
========

Example 1: Android XML Assignment
  Name: "Android XML"
  ID: "164"
  Description: "Modify activity_main.xml to change text to 'Hi Android'"

Example 2: Python Assignment
  Name: "Python Functions"
  ID: "165"
  Description: "Implement sorting functions"

Example 3: JavaScript Assignment
  Name: "Web Development"
  ID: "166"
  Description: "Create responsive web page"


MORE INFORMATION
================

See TEMPLATE_GUIDE.md for comprehensive documentation
See USAGE.md for detailed usage examples
Check ARCHITECTURE.md for system architecture details
